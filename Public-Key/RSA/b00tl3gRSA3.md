# b00tl3gRSA3

Platform: picoCTF

## Description

> Why use p and q when I can use more?
>*(AUTHOR: INVISIBILITY)*

```bash
nc jupiter.challenges.picoctf.org 51575
```

## Solution

The provided description states that its used d to encrypt instead of. When we try to connect to the service,

```bash
┌──(meld㉿meld)-[~]
└─$ nc jupiter.challenges.picoctf.org 18243
c: 66570801579691260468479048206044649242961752044883455688496298118655949743319917670464280380099960948715501619899476313013877854350284598537057756787921950401554629840724066243914240844981056853763509225470971998771122814607585150977908048446484350969746216183438774151134778430693873573339518272844043304796
n: 92619206989300121079897575653422406240396348054719369714268659753148617791035643364618674731132959869515940711125381782443850238891992862929552650663587721980423998441332790701810257778137219731399065634286247517376192644079209529336380194599860160429710319458879570788670647476954592623804178696958365867123
e: 37910039023574099332716670993531227358570456941389552353407339333173805213002290816727893398578538054835667021315262619803413074420216191587732881487567940507958529569415144799767379011097270962769885955575147223618238208343671375500781563246195304410579939900521584444904172634746643840768212464682725166273
```

It can be seen that the value of e is very big, we can confirm that `d` and `e` were swapped. This kind of scenario leaves RSA vulnerable to [Wiener's attack](https://en.wikipedia.org/wiki/Wiener%27s_attack). This attack  exploits cases where the private exponent `d` is too small compared to the modulus `n` and the encryption exponent (e). When d is small, it opens up the possibility of efficiently recovering the private key from the public key.

We easily can perform the attack using [CTF Solver: Low exponent in RSA](https://asecuritysite.com/rsa/rsa_ctf05).

`Solver:`

```console
Bob uses RSA to send an encrypted message to Alice. The public exponent (e) is 37910039023574099332716670993531227358570456941389552353407339333173805213002290816727893398578538054835667021315262619803413074420216191587732881487567940507958529569415144799767379011097270962769885955575147223618238208343671375500781563246195304410579939900521584444904172634746643840768212464682725166273 and the modulus (N) is 92619206989300121079897575653422406240396348054719369714268659753148617791035643364618674731132959869515940711125381782443850238891992862929552650663587721980423998441332790701810257778137219731399065634286247517376192644079209529336380194599860160429710319458879570788670647476954592623804178696958365867123. With a cipher of 66570801579691260468479048206044649242961752044883455688496298118655949743319917670464280380099960948715501619899476313013877854350284598537057756787921950401554629840724066243914240844981056853763509225470971998771122814607585150977908048446484350969746216183438774151134778430693873573339518272844043304796, determine the decrypted message:

Answer:
Using Wiener attack. Loops:  1
Found d: 65537
Found p: 8009118931049338787231130176392330327649622378999454901964717192169621323055365785366740121523668673616728611343593953676069558318767394101554553938637139
Found q: 11564219208961769945884758190677501883802669509901540444393506401128317376094242925813490087130138252824957277245656387623337931565659115525779947325301857
Found PHI: 92619206989300121079897575653422406240396348054719369714268659753148617791035643364618674731132959869515940711125381782443850238891992862929552650663587702407085858430224057585921890708305008279107176733290901159152599346140510379727669014369651506622783877772990981538329348069464708197294551362457101928128
Now using C^d mod N

Decipher: b'picoCTF{bad_1d3a5_4783252}'
```

**flag:** `picoCTF{bad_1d3a5_4783252}`
