# Familiar

Platform: MapleCTF

## Description

> A sweet classical cipher. Why use a computer when I have a pen and paper?
> >*(Author: vEvergarden)*

Two files were attached:

`source.py`:

```python
import string
import random

ALPHABET = string.ascii_uppercase


def generate_key():
    return [random.randint(0, 26) for _ in range(13)]


def generate_keystream(key, length):
    keystream = []
    while len(keystream) < length:
        keystream.extend(key)
        key = key[1:] + key[:1]
    return keystream


def encrypt(message, key):
    indices = [ALPHABET.index(c) if c in ALPHABET else c for c in message.upper()]
    keystream = generate_keystream(key, len(message))
    encrypted = []

    for i in range(len(indices)):
        if isinstance(indices[i], int):
            encrypted.append(ALPHABET[(keystream[i] + indices[i]) % 26])
        else:
            encrypted.append(indices[i])

    return "".join(encrypted)


with open("plaintext.txt", "r") as f:
    plaintext = f.read()

key = generate_key()
ciphertext = encrypt(plaintext, key)

with open("ciphertext.txt", "w") as f:
    f.write(ciphertext)
```

`ciphertext.txt`:

```text
OJUIMBBQXAMI VVW KKVEFNWDMXAG BKIQQJIUIX BH RDDQFQ IV XUWUKQDMOQGO CJEHEZ JN KRYTDRUOGMQMG ZWMKBQZBML BAPF FGEC IIZMFOHFMZOA BW QWDYD DVMMTEBRFKMX TBUQMP. HZ OPXAM FCFDDEZ VWVMBHFR, OMTUA LG HDPUDBLCTIH BEYBZMM BK M LUDOCIT XGQMQ, VQFQGD FN OMKBNZX SUFYFMG YTIDH GYPPZV EQMWUM UZOZBKIMB RUOGMQMG LVHSUYE.

KZRMIAWDMKPR, T EUUAFVT IAIBRF ER KMNA, AUDI VB BPX WQZHF WY NEXV OHAFZVBQHK. OQDFDKQXTKIE UZOJCGBXO QMSDKKBXL JTERQSQN, MVZGKOJQP NBTML, ZDP XZRXBHDDZFTUX TTOHOXSXYE BAIB OTCKUDZ WMKBMWQQUZB. ACVZTER PZUTVLL P CUQK NVLXOHFZDPUVZ WY RDXFFABKIXAFR OHUZXQXTXP, HDOXPLBVZ HKLCQFMQV TKS ZIKYHMMZQZ QMSDKKBBWV, TZIT ACGKBBLZR, MIL XCUIXB-WQT BVNKXHFHGOOCKM.

EMQFUXQIIVMP QMWMBM QV PDXUYZB T XEBITNHM WY UBKS-AUZPDGO IROLKUE, ZIVZFCS VDAH VTTPHUB OUKPXZL IA SGFOQGO-BSSD ODTXMWOKPBGYO KZHBWVLXR. FCM KPTIADDSQN HNBXK YYDDJZ ZMTI-INDXY LKMGXGUNI, ABUCEXIUMW XGUMZ QWDDQFE TVL BBBGQEUUBVO QWQ SDUOQKIE GAKU AA VZRMIAFHMBCG QG HMEUSGVZWQVD EDDEUOQOM BCRNHYMOQHV.

ONCBQOQMWZL JSYXUUM I OXGUUFK WY KKVEFNSDVXAQK QDAKI VVW BXZWZHGGZA BW DPUM MZ TLDTKIMFU. OAM YIPS OAG IZM IDAJYZS NHZ FH UYSQIMKMPFITZJIUNB. BETK CMK MQXTHXF MQMFVXAAXP HD OMGIBWZOPOXUO QFXTXJTZJMFDWGA, IPGMOT KKGXMXCMKOEDA IBMXRWR, JZ KZXXIUUUXK NAM ZGKOJASMTXPBZ BQYYUOQDML IA CMZDXNTTQT ZDP MMMZBBKQ VXMBA.

QWDNKST BAMAX ONCBQOQMQWGP, QEBDZBVO ZGXFFABZTXPXOH QZP KRJMKPTOTDUOG MVMEJEHQEOA ZMYFCQ JTZQK ADFAXR MZL TMTOC SE FCBVS IXWD EQVAWVXA BQERQNABWGXAE. OAGTTJHOPFHEZ, TTBMOPX JTUISBVO, MMT DZTXVBEBER BQMAXDMKXCBU MMM MALBCFYMX IMBZBYJFDE VA KWGQTESQZOA VIOFVMSU OPKWCZE FGU XIUGZBKIT ER XKGXMLVDZFTUX MVBDBMR.

DV BAB QMT, OPXG CDESUD V VWUJJZHJK JN PQZWXX EWDTEML FZCYHUYCTTA TWN NAGAMMZ ZNNUDEZKNZQMV BQMOOQVMA XCP HQDVYWZVB FGU DUIWZMXCOD AR KWJNPI BHKBOHOZTMWK YZ NINMZRPDCYZS LBOBQPX QEEZBL TDPUMIF HIEQKFDGR MOOWKA. PE JQOCVHTWZV BEZFDVNMA QD UHAGDX, METEU OJUIMBBQXAME MMFIQG PF JTZ YWZXCGAMJ JN PWGFCS JTQ GMFM VQMUDMOBWV LU BONQMAMKNOXFX PQAMGLXOH, UZEPZBVZ DGQ PUBQMIT LAQBP NBTGA HQBKDQ IGL KBEHBUQIB.
```

## Solution
<!-- This code section is a work in progress - TODO: Update with the solucion -->
**Flag:** `flag`
